{% extends 'portfolio/base.html' %}
{% load static %}

{% block title %}{{ profile.full_name }} - CV Portfolio{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section bg-gradient-primary text-white py-5" style="margin-top: 76px;">
    <div class="container">
        <div class="row align-items-center min-vh-75">
            <div class="col-lg-6" data-aos="fade-right">
                <h1 class="display-4 fw-bold mb-3">
                    Xin chào, tôi là
                    <span class="text-warning">
                        {% if profile %}{{ profile.full_name }}{% else %}Tên của bạn{% endif %}
                    </span>
                </h1>
                <h2 class="h3 mb-4 text-light">
                    {% if profile %}{{ profile.title }}{% else %}Lập trình viên{% endif %}
                </h2>
                <p class="lead mb-4">
                    {% if profile %}{{ profile.about|truncatewords:30 }}{% else %}Mô tả ngắn về bản thân bạn{% endif %}
                </p>
                <div class="hero-buttons">
                    <a href="{% url 'projects' %}" class="btn btn-warning btn-lg me-3">
                        <i class="fas fa-folder"></i> Xem dự án
                    </a>
                    <a href="{% url 'contact' %}" class="btn btn-outline-light btn-lg">
                        <i class="fas fa-envelope"></i> Liên hệ
                    </a>
                </div>
            </div>
            <div class="col-lg-6 text-center" data-aos="fade-left">
                <div class="hero-image">
                    {% if profile.profile_image %}
                        <img src="{{ profile.profile_image.url }}" alt="{{ profile.full_name }}" 
                             class="img-fluid rounded-circle shadow-lg profile-img">
                    {% else %}
                        <div class="profile-placeholder">
                            <i class="fas fa-user fa-10x text-warning"></i>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Skills Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5" data-aos="fade-up">
                <h2 class="section-title">Kỹ năng của tôi</h2>
                <p class="text-muted">Những công nghệ và kỹ năng tôi thành thạo</p>
            </div>
        </div>
        <div class="row">
            {% for skill in skills %}
                <div class="col-md-6 col-lg-4 mb-4" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:100 }}">
                    <div class="skill-item bg-white p-4 rounded shadow-sm h-100">
                        <h5 class="mb-3">{{ skill.name }}</h5>
                        <div class="progress mb-2" style="height: 8px;">
                            <div class="progress-bar bg-primary" 
                                 data-percentage="{{ skill.percentage }}"
                                 style="width: 0%;"></div>
                        </div>
                        <small class="text-muted">{{ skill.get_level_display }} - {{ skill.percentage }}%</small>
                    </div>
                </div>
            {% empty %}
                <div class="col-12 text-center">
                    <p class="text-muted">Chưa có kỹ năng nào được thêm.</p>
                </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured Projects Section -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5" data-aos="fade-up">
                <h2 class="section-title">Dự án nổi bật</h2>
                <p class="text-muted">Những dự án tôi tự hào nhất</p>
            </div>
        </div>
        <div class="row">
            {% for project in featured_projects %}
                <div class="col-md-6 col-lg-3 mb-4" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:100 }}">
                    <div class="project-card bg-white rounded shadow-sm overflow-hidden h-100">
                        {% if project.image %}
                            <img src="{{ project.image.url }}" alt="{{ project.title }}" 
                                 class="card-img-top project-img">
                        {% else %}
                            <div class="project-placeholder bg-light d-flex align-items-center justify-content-center">
                                <i class="fas fa-image fa-3x text-muted"></i>
                            </div>
                        {% endif %}
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">{{ project.title }}</h5>
                            <p class="card-text text-muted flex-grow-1">{{ project.description|truncatewords:15 }}</p>
                            <div class="project-meta">
                                <small class="text-muted d-block mb-2">
                                    <i class="fas fa-tag"></i> {{ project.get_project_type_display }}
                                </small>
                                <a href="{% url 'project_detail' project.pk %}" class="btn btn-primary btn-sm">
                                    Xem chi tiết
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            {% empty %}
                <div class="col-12 text-center">
                    <p class="text-muted">Chưa có dự án nổi bật nào.</p>
                </div>
            {% endfor %}
        </div>
        {% if featured_projects %}
            <div class="row">
                <div class="col-12 text-center mt-4" data-aos="fade-up">
                    <a href="{% url 'projects' %}" class="btn btn-outline-primary btn-lg">
                        Xem tất cả dự án <i class="fas fa-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>
        {% endif %}
    </div>
</section>

<!-- Experience & Education Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row">
            <!-- Experience -->
            <div class="col-lg-6 mb-5">
                <h3 class="mb-4" data-aos="fade-up">Kinh nghiệm làm việc</h3>
                <div class="timeline">
                    {% for experience in experiences %}
                        <div class="timeline-item" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:100 }}">
                            <div class="timeline-content bg-white p-4 rounded shadow-sm">
                                <h5 class="mb-1">{{ experience.position }}</h5>
                                <h6 class="text-primary mb-2">{{ experience.company }}</h6>
                                <p class="text-muted small mb-2">
                                    <i class="fas fa-calendar"></i>
                                    {{ experience.start_date|date:"m/Y" }} - 
                                    {% if experience.is_current %}Hiện tại{% else %}{{ experience.end_date|date:"m/Y" }}{% endif %}
                                </p>
                                <p class="mb-0">{{ experience.description|truncatewords:20 }}</p>
                            </div>
                        </div>
                    {% empty %}
                        <p class="text-muted">Chưa có kinh nghiệm làm việc nào được thêm.</p>
                    {% endfor %}
                </div>
            </div>
            
            <!-- Education -->
            <div class="col-lg-6 mb-5">
                <h3 class="mb-4" data-aos="fade-up">Học vấn</h3>
                <div class="timeline">
                    {% for edu in education %}
                        <div class="timeline-item" data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:150 }}">
                            <div class="timeline-content bg-white p-4 rounded shadow-sm">
                                <h5 class="mb-1">{{ edu.degree }}</h5>
                                <h6 class="text-primary mb-2">{{ edu.institution }}</h6>
                                <p class="text-muted small mb-2">
                                    <i class="fas fa-calendar"></i>
                                    {{ edu.start_date|date:"m/Y" }} - {{ edu.end_date|date:"m/Y" }}
                                </p>
                                <p class="mb-1"><strong>Chuyên ngành:</strong> {{ edu.field_of_study }}</p>
                                {% if edu.gpa %}
                                    <p class="mb-0"><strong>GPA:</strong> {{ edu.gpa }}</p>
                                {% endif %}
                            </div>
                        </div>
                    {% empty %}
                        <p class="text-muted">Chưa có thông tin học vấn nào được thêm.</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="py-5 bg-primary text-white">
    <div class="container text-center">
        <div class="row">
            <div class="col-lg-8 mx-auto" data-aos="fade-up">
                <h2 class="mb-4">Sẵn sàng làm việc cùng nhau?</h2>
                <p class="lead mb-4">Hãy liên hệ với tôi để thảo luận về dự án của bạn</p>
                <a href="{% url 'contact' %}" class="btn btn-warning btn-lg">
                    <i class="fas fa-envelope"></i> Liên hệ ngay
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate skill progress bars
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const skillObserver = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const progressBar = entry.target.querySelector('.progress-bar');
                if (progressBar) {
                    const percentage = progressBar.getAttribute('data-percentage');
                    progressBar.style.width = '0%';
                    setTimeout(() => {
                        progressBar.style.width = percentage + '%';
                    }, 300);
                }
            }
        });
    }, observerOptions);

    // Observe skill items
    document.querySelectorAll('.skill-item').forEach(skill => {
        skillObserver.observe(skill);
    });
});
</script>
{% endblock %}
